# FGAPA Supplementary materials

## 前言

本文档旨在帮助非高光谱图像分析方向读者快速了解基本概念和任务需求。解答审稿人提出的问题的同时对于FGAPA的所有实验与补充实验进行展示。



## 关于FSL(**to Reviewer 1178,Q1**,Q4)

FSL

少样本学习（FSL）因其从非常有限的样本中学习和泛化的能力而引起了人们的关注。 FSL 本质上是一种元学习方法，可以从不同的任务中获取可转移的知识，以快速适应新任务。 通常，它在 N-way K-shot 设置下运行，每类使用 K 个标记样本来训练 N 类分类器 。



<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251216200323548.png" alt="替代文本" title="图片标题">

<center><p>Fig1：few shot learning(FSL)</p></center>



以自然图像为例，FSL任务由带标签的样本组成的集合Support set与查询样本组成的集合Query set组成。查询集与支持集构建FSL任务并一同输入特征提取器中进行特征提取。**Support features**代表支持集经由特征提取器提取得到的特征表示，**Query features**则是查询集经提取得到的特征表示。FSL的损失通过度量学习，计算由查询特征到每个类的支持特征之间的距离来判定其类别并在度量空间中拉近同类特征并推开异类特征。通过这样的FSL任务，让模型学会学习，通过给定的支持集判定查询集样本的类别。



## 关于源域目标域及其选择(to Reviewer 1702 ,to Reviewer 1178 Q1)

源域与目标域

在跨域少样本学习问题的设置中，通常由包含 $C_s$ 个类的源域数据 $D_s$ 及包含 $C_t$ 个类的目标域数据 $D_t$ 构成。$D_s$ 中的类称为基类，$C_t$ 中的类称为新类，两者的实际类别通常不同。为了训练样本的多样性，$C_s$ 通常大于 $C_t$。与 $C_s$ 中丰富的标记样本不同，$C_t$ 中仅有少量标记样本 $D_l$ 和大量无标记样本 $D_u$。为了满足构建元学习任务的需求，通过随机高斯噪声进行数据增强以扩充标记样本 $D_l$。提出的FGAPA方法使用源域数据 $D_s$ 和目标域数据 $D_t$ 中的标记样本 $D_l$ 来训练特征提取器，并最终在目标域 $D_t$ 上用无标记样本 $D_u$ 进行分类性能测试。

**总的来说，源域是具有丰富标记样本的数据，而目标域则是进行下游分类任务的仅带有少量标记样本的数据。我们要做的是将模型在源域训练得到的知识充分迁移到目标域上用于分类任务。**

**对于源域的选取，为了方便下游任务的进行，源域的类别数通常要大于或等于目标域类别数，这样训练得到的度量空间才可为目标域任务服务。本文仅采用了Chikusei作为源域，但我们的方法对于不同的源域都具有很好的鲁棒性和健壮性。为此我们进行了Hanchuan源域的实验，由于时间问题，只进行部分予以论证并在后续会进行补全。**

对于DFSL和DM-MRN竞争力不强的方法，以及HFSL和FSCF-SSL使用预训练VGG七层等高训练时间低精度的方法暂不使用，但后续会继续完善并补充。

<center><p>Table1：IP-5shot-Hanchuan</p></center>

| IP-5shot                  |      DCFSL       |     CTF-SSCL     |       MLPA       |      FGAPA       |
| ------------------------- | :--------------: | :--------------: | :--------------: | :--------------: |
| train time per DataSet(s) |    2023.52402    |    2587.71192    |    2126.25778    |    2347.09134    |
| test time per DataSet(s)  |     0.47259      |     0.75173      |     0.52211      |     0.97493      |
| average OA                |   69.53 ± 2.85   |   70.59 ± 4.22   |   68.13 ± 3.21   |   76.37 ± 2.56   |
| average AA                |   80.72 ± 1.56   |   81.69 ± 1.75   |   79.61 ± 1.84   |   85.76 ± 1.18   |
| average Kappa             | 65.7726 ± 3.1936 | 66.9550 ± 4.5188 | 64.2377 ± 3.5088 | 73.3409 ± 2.7795 |
| seed:1309                 |   73.32087718    |    75.326974     |   75.18930082    |    80.1848756    |
| seed:1310                 |   71.28527879    |    73.468384     |   64.85396794    |   78.65080146    |
| seed:1332                 |   64.79496509    |    67.450093     |   71.65896352    |    75.3958108    |
| seed:1330                 |   69.07267185    |    73.488052     |   68.66948569    |   75.71049267    |
| seed:1236                 |   69.38735372    |    61.648146     |   65.88651785    |   76.38902547    |
| seed:1336                 |   64.17543515    |    69.603698     |   65.07031173    |   74.20591995    |
| seed:1337                 |   70.31173173    |    74.176419     |   70.44940505    |   80.04720228    |
| seed:1224                 |   71.57045924    |    69.525027     |   67.48942866    |   72.41616678    |
| seed:1246                 |    69.1316747    |    74.736946     |   66.67322254    |   73.26187432    |
| seed:1227                 |   72.27849346    |    66.456879     |   65.40466123    |   77.39207395    |



<center><p>Table2：SA-5shot-Hanchuan</p></center>

| SA-5shot                  |      DCFSL       |     CTF-SSCL     |       MLPA       |      FGAPA       |
| ------------------------- | :--------------: | :--------------: | :--------------: | :--------------: |
| train time per DataSet(s) |    2077.18069    |    2675.90003    |    2264.48634    |    2510.91029    |
| test time per DataSet(s)  |     2.57945      |     2.64535      |     3.93145      |     7.51542      |
| average OA                |   91.06 ± 0.99   |   89.79 ± 1.70   |   90.99 ± 1.07   |   92.08 ±0.87    |
| average AA                |   94.95 ± 0.62   |   93.82 ± 1.01   |   94.61 ± 0.85   |   95.22 ± 1.03   |
| average Kappa             | 90.0684 ± 1.1004 | 88.6587 ± 1.8889 | 89.9792 ± 1.1822 | 91.1873 ± 0.9733 |
| seed:1309                 |   92.27922811    |    90.127477     |   92.73622084    |   93.22836685    |
| seed:1310                 |   89.50396862    |    90.995208     |   89.62052952    |   92.02390424    |
| seed:1332                 |   92.06460804    |    91.700124     |   92.24777517    |   92.63816167    |
| seed:1330                 |   90.51786342    |    88.954467     |   91.98875095    |   92.25147551    |
| seed:1236                 |   91.92584507    |    91.056264     |   90.18853263    |   90.58446965    |
| seed:1336                 |   89.29489907    |    88.961868     |   90.14597865    |   91.23203019    |
| seed:1337                 |   91.81298451    |    90.281041     |   91.09511739    |    92.8620326    |
| seed:1224                 |   90.89344854    |    89.801846     |   89.61127865    |   92.93603952    |
| seed:1246                 |   91.40594646    |     85.34848     |   90.56596792    |   90.83054266    |
| seed:1227                 |   90.90824992    |    90.701031     |   91.68162223    |    92.2588762    |



<center><p>Table3：Botswana-5shot-Hanchuan</p></center>

| Botswana-5shot            |      DCFSL       |     CTF-SSCL     |       MLPA       |      FGAPA       |
| ------------------------- | :--------------: | :--------------: | :--------------: | :--------------: |
| train time per DataSet(s) |    1601.37918    |    1830.86138    |    1658.64524    |    2028.85821    |
| test time per DataSet(s)  |     0.15149      |     0.27293      |     0.13654      |     0.24728      |
| average OA                |   97.15 ± 0.83   |  95.34 ± 1.397   |   96.38 ± 1.13   |   97.65 ±0.97    |
| average AA                |   97.06 ± 0.96   |   95.60 ± 1.36   |   96.31 ± 1.18   |   97.58 ± 1.09   |
| average Kappa             | 96.9074 ± 0.9049 | 94.9482 ± 1.5119 | 96.0823 ± 1.2286 | 97.4494 ± 1.0475 |
| seed:1309                 |   96.82190057    |    94.808055     |   97.01069855    |   97.41976086    |
| seed:1310                 |   98.55254877    |    97.828823     |   97.32536186    |   99.27627439    |
| seed:1332                 |   95.90937697    |    94.052863     |   94.30459408    |    96.3499056    |
| seed:1330                 |   95.87791064    |    95.342983     |   96.19257395    |   96.47577093    |
| seed:1236                 |   97.35682819    |     96.9163      |   96.82190057    |   98.42668345    |
| seed:1336                 |   98.01762115    |    95.720579     |   94.30459408    |   96.72750157    |
| seed:1337                 |   96.97923222    |    95.531781     |   96.38137193    |   98.20641913    |
| seed:1224                 |   96.66456891    |    96.381372     |   96.82190057    |   97.16803021    |
| seed:1246                 |   97.95458848    |    93.266205     |   97.92322215    |   98.89867841    |
| seed:1227                 |   97.32536186    |    93.517936     |    96.7589679    |   97.51415985    |

显然，我们的方法不仅在Chikusei源域上效果好，在Hanchuan等其他源域上也有很强的健壮性与稳定性。我们下一步需要解决的问题为如何调整学习率，对损失的超参数重新寻优以构建新源域下的对抗域适应策略。

## 关于下游任务(to Reviewer 1178 Q3)

对于高光谱图像的分类是精确到每一个高光谱像素的，因此审稿人误以为是图像分割。然而图像分割重要的是对区域的划分，像素点与其临近像素应该划分为某个类的对应代表区域。但是从文中的对比方法的分类图中，可以看到部分区域散落着各个类别的像素点。因此其应对应分类任务而非语义分割。

<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/DFSL-IP.png" alt="替代文本" title="图片标题" width=500>

<center><p>Fig2: downstream task</p></center>



## 关于模型图文本对应问题(to Reviewer 1178 Q4)

![image-20251216203011245](https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251216203011245.png)

<center><p>Fig3: Revised FGAPA Overall Framework</p></center>

我们对审稿人提到的注意力分数在文中无对应问题进行了修改，由**Correlation calculation**替代。同时，$p_i$代表原型库的每类原型。



## 关于方法(to Reviewer 1178 Q6,Q7,Q8)

- FFA

  对于审稿人提到的为什么通过MLP层进行特征与原型的变换及MLP的权重与偏置维度问题：

  首先，特征与原型来自于不同的语义层次。通过MLP层将其共同映射到同一个可比较的特征空间。同时MLP层中间的Relu可以确保模型学习更复杂的非线性关系以提高其表达能力。

  经由特征提取得到的特征最终都被统一为128*1的特征维度，MLP层权重分别对应（64，128）其中64代表输出维度，偏置为64。第二层权重则对应（128，64），偏置为128。这种设计在减少参数量的同时能够迫使模型学习重要特征。

- ACA

  对于公式（7）和公式{10}：公式（10）是在公式（9）的基础上进行的。它们都使用了余弦相似度。使用余弦相似度的原因是其与原型学习天然契合，更适合高维嵌入空间，且优化稳定。同时，余弦相似度配合温度系数可以灵活控制softmax平滑程度，提升训练稳定性。



## 关于超参数与最终损失(to Reviewer 1178 Q9,Q10,Q12)

对于温度参数，我们根据经验将其设定为普适性的0.1。

最终损失被定义为：
$$
Loss = L_{\text{fsl}} + \lambda_1 L_{\text{in}} + \lambda_2 L_{\text{cross}}
$$
$\lambda_1$和$\lambda_2$代表域内损失和跨域损失的权重超参数。其取值范围在0~1之间，间隔为0.1。通过寻优得到的最佳参数为$\lambda_1$=0.5，$\lambda_2$=0.3.



## 关于本文的创新点(to Reviewer 1178 Q11)

1. FFA：通过滑动平均更新并结合动量观念，通过对特征语义关联信息的注入，引导模型提高判别性特征提取能力。我们对特征与原型之间进行蒸馏并将得到的语义信息注入以增强特征表示，提高特征判别性。
2. CCA：我们首次提出了对于高光谱图像跨域域适应的双域对齐功能。其思想在于迁移学习的本质即是寻找一个共同的度量空间，使在源域和目标域都有良好的性能表现。在高光谱图像分类领域的域适应通常是在单个域内进行，我们首次以联合的视角，对源域和目标域进行统一建模，进行双域对齐。此外，非高光谱领域的双域对齐要求源域与目标域的类别对应，而我们解开了这个限制，让源域和目标域在类别不同时依旧能寻求一个度量空间进行普适性域适应。



## 关于数据集(to Reviewer 1178 Q13)

本文使用公开数据集Chikusei作为源域，并在三个公开数据集Indian_pines、Salinas和Botswana上进行验证。

Chikusei



<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251216211502343.png" alt="替代文本" title="图片标题" width=500>

<center><p>Fig4: Details of the Chikusei dataset</p></center>

该数据集由日本筑西市的 Headwall Hyperspec-VNIR-C 传感器捕获。 它由 2517 × 2335 像素组成，空间分辨率为 2.5 m。 总共提供128个频段，覆盖波长从343到1018 nm，共19个类别。

发布链接：https://naotoyokoya.com/Download.html

Indian_pines



<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251216211903236.png" alt="替代文本" title="图片标题" width=500>

<center><p>Fig5: Details of the Indian_pines dataset</p></center>

该数据集由美国印第安纳州上空的机载可见光/红外成像光谱仪 (AVIRIS) 收集。 它包含 145 × 145 像素，空间分辨率约为 20 m。 去除 20 个水吸收带（104-105、150-163 和 220）后，使用 400 至 2500 nm 范围内的 200 个吸收带。 该数据集包括 16 个类。

发布论文：https://purr.purdue.edu/publications/1947/1

Salinas



<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251216212045332.png" alt="替代文本" title="图片标题" width=500>

<center><p>Fig6: Details of the Salinas dataset</p></center>

该数据集由美国加利福尼亚州萨利纳斯山谷的 AVIRIS 传感器收集。 它由 512 × 217 像素组成，空间分辨率约为 3.7 m。 总共使用了覆盖 400-2500 nm 的 204 个波段，分为 16 个类别。

发布链接：http://www.ehu.eus/ccwintco/index.php/Hyperspectral_Remote_Sensing_Scenes

Botswana



<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251216212159994.png" alt="替代文本" title="图片标题" width=500>

<center><p>Fig7: Details of the Botswana dataset</p></center>

该数据集由 NASA 的 EO1 卫星在 BO 奥卡万戈三角洲上空获取。 它的尺寸为1476×256像素，空间分辨率约为20m。 在242个光谱波段（400-2500 nm）中，去除噪声波段后使用145个波段（1-9、56-81、98-101、120-133和165-186）。 它包含 14 个类。

发布链接：http://www.ehu.eus/ccwintco/index.php/Hyperspectral_Remote_Sensing_Scenes

**在实验过程中，我们使用的是公开的已经去除噪声波段的高光谱数据集。**



## 关于实验(to Reviewer 1178 Q14,Q15,Q16)

**由于文章严格的篇幅限制，在论文中的实验并未进行详尽的展示而让审稿人产生误解。为此，我们将所有实验的工作都给予展示。**

**batch-size设定为64**

- **三个衡量指标**

  OA:模型整体分类正确的比例，即所有被正确分类的样本占总样本数的百分比。
  $$
  OA = \frac{\text{Total number of correctly classified samples}}{\text{Total sample size}} = \frac{\sum_{i=1}^{K} TP_i}{N}
  $$
  

​        AA：每个类别分类精度的平均值，消除类别数带来的影响。
$$
PA_i = \frac{TP_i}{\text{Number of actual samples in class } i} = \frac{TP_i}{TP_i + FN_i}
$$

$$
AA = \frac{1}{K} \sum_{i=1}^{K} PA_i
$$

​        Kappa：考虑分类结果与随机分类带来的一致性差异。
$$
\kappa = \frac{OA - EA}{1 - EA}
$$
​        OA:总体分类精度   EA：期望一致性
$$
EA = \frac{\sum_{i=1}^{K} (\text{row sum}_i \times \text{column sum}_i)}{N^2}
$$
$R_i$ is the row sum for class $i$ (actual number of samples in class $i$),  
$C_i$ is the column sum for class $i$ (predicted number of samples in class $i$),  
and $N$ is the total number of samples.



**对比实验**

所有实验都是在同一电脑同一GPU下进行，运行十次（10 seeds）取均值



<center><p>Table4：Indian_pines-5shot-Chikusei</p></center>

| IP-5shot      | DFSL+NN     |    DCFSL    | HFSL        | DM-MRN      | FSCF-SSL    |  CTF-SSCL   |    MLPA     |    FGAPA     |
| ------------- | ----------- | :---------: | ----------- | ----------- | ----------- | :---------: | :---------: | :----------: |
| average OA    | 63.16±2.92  | 65.74±2.57  | 74.03±2.71  | 69.28±3.30  | 76.96 ±2.74 | 70.86±3.215 | 66.59±2.81  |  79.65±2.76  |
| average AA    | 75.64±1.06  | 77.14±1.70  | 83.17±2.25  | 81.51±1.84  | 85.29±2.60  | 81.32±2.28  | 78.02±1.43  | 87.74 ± 1.37 |
| average Kappa | 58.71±3.08  | 61.47±2.66  | 70.64±2.98  | 65.66±3.61  | 73.87±3.06  | 67.10±3.49  | 62.43±2.99  |  77.01±3.27  |
| seed:1309     | 66.61421969 | 69.65286656 | 75.9661717  | 0.724161668 | 82.39748254 | 0.68718655  | 70.69525027 |  83.8233848  |
| seed:1310     | 64.93263841 | 64.63762415 | 77.80509391 | 0.734585505 | 78.43445767 | 0.65729177  | 70.80342217 | 83.29235913  |
| seed:1332     | 58.84551087 | 66.93873537 | 74.28459042 | 0.670469073 | 77.30356967 | 0.69731537  | 65.36532599 | 76.58570164  |
| seed:1330     | 62.8675386  | 69.15134231 | 72.92752483 | 0.649719736 | 78.57213099 | 0.74648441  | 66.97807061 | 75.43514603  |
| seed:1236     | 63.31989379 | 66.72239158 | 74.23542138 | 0.676074344 | 75.26797129 |  0.7593667  | 62.60202576 |  81.6599469  |
| seed:1336     | 60.37958501 | 63.18222047 | 70.57724457 | 0.754843151 | 71.5212902  |  0.7164913  | 65.61117121 | 74.79594847  |
| seed:1337     | 67.36158914 | 65.7193431  | 69.1316747  | 0.671255777 | 74.36326089 | 0.66574884  | 66.26020258 | 81.72878356  |
| seed:1224     | 58.44232471 | 60.46808929 | 77.85426296 | 0.657685121 | 76.30052119 | 0.72907857  | 62.37584817 |  80.7552365  |
| seed:1246     | 63.79191661 | 64.82446652 | 72.51450487 | 0.694561904 | 77.74609106 | 0.73281542  | 69.34801849 |  76.4283607  |
| seed:1227     | 65.01130888 | 66.12252926 | 75.0516275  | 0.694463566 | 77.64775297 | 0.69446357  | 65.84718261 | 81.97462877  |



<center><p>Table5：Indian_pines-4shot-Chikusei</p></center>

| IP-4shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL   |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :----------: | :----------: | :----------: |
| average OA    | 60.44 ±  2.82 | 61.96 ± 3.98 | 69.96 ± 3.93 | 63.95 ± 3.07 | 72.92 ± 5.56 | 67.29 ±3.04  | 63.31 ± 2.05 | 76.12 ± 2.76 |
| average AA    | 72.24 ±  1.59 | 73.77 ± 2.32 | 80.76 ± 1.96 | 78.68±1.96   | 82.52 ± 3.22 | 79.00 ± 1.83 | 75.08 ± 1.82 | 85.84 ± 1.37 |
| average Kappa | 55.60 ±  2.99 | 57.18 ± 4.33 | 66.11 ± 4.32 | 59.96±3.29   | 69.43 ± 6.12 | 63.17 ± 3.28 | 58.83 ± 2.02 | 72.71 ± 3.27 |
| seed:1309     | 64.21207658   | 64.00589102  | 75.58173785  |              | 83.77025037  |  0.67088856  | 65.87137948  | 78.78252332  |
| seed:1310     | 58.47815415   |  64.7520864  | 70.41728031  |              | 78.12469318  |  0.60756014  | 60.24545901  | 75.11045655  |
| seed:1332     | 55.46391753   | 61.21747668  | 64.22189494  |              | 66.54884634  |  0.66941581  | 61.88512518  | 75.69955817  |
| seed:1330     | 58.85125184   | 61.52184585  | 68.56161021  |              | 71.42857143  |  0.71045655  | 65.31173294  | 75.04172803  |
| seed:1236     | 58.87088856   | 51.89985272  | 77.71232204  |              | 80.37309769  |  0.66961217  |  66.9808542  | 78.79234168  |
| seed:1336     | 61.7574865    | 67.09867452  | 70.60382916  |              | 70.76092293  |  0.70004909  | 63.38733432  | 73.81443299  |
| seed:1337     | 64.89936181   | 63.10260187  | 69.9754541   |              | 69.95581738  |  0.63102602  | 62.60186549  | 75.57191949  |
| seed:1224     | 58.0952381    | 60.35346097  | 65.09572901  |              | 67.11831124  |  0.69769269  | 62.16985763  | 81.36475209  |
| seed:1246     | 61.59057437   | 60.36327933  | 68.37506136  |              | 68.54197349  |  0.67943054  | 63.50515464  | 74.74717722  |
| seed:1227     | 62.21894944   | 65.31173294  | 69.05252823  |              | 72.57731959  |  0.69297987  | 61.16838488  | 72.27295042  |



<center><p>Table6：Indian_pines-3shot-Chikusei</p></center>

| IP-3shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL   |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :----------: | :----------: | :----------: |
| average OA    | 56.47 ±  2.44 | 56.03 ± 3.45 | 63.65 ± 4.13 | 62.40 ± 2.49 | 67.72 ± 1.62 | 63.61 ± 3.5  | 57.65 ± 2.63 | 71.19 ± 4.18 |
| average AA    | 68.38 ±  1.99 | 68.71 ± 2.23 | 76.13 ± 2.74 | 77.32 ± 1.38 | 77.70 ± 2.46 | 75.47 ± 2.60 | 70.16 ± 2.83 | 81.35 ± 2.02 |
| average Kappa | 51.16 ±  2.52 | 50.73 ± 3.75 | 59.37 ± 4.40 | 58.44 ± 2.59 | 63.58 ± 1.62 | 59.15 ± 3.64 | 52.44 ± 2.78 | 67.50 ± 4.55 |
| seed:1309     | 57.41593961   | 59.85687678  | 63.54278992  |              | 68.80697971  |  0.63748652  | 56.84736791  | 73.55161259  |
| seed:1310     | 56.46505245   | 52.62229193  | 65.013234    |              | 68.72855602  |  0.57200274  | 62.24879914  | 67.50318596  |
| seed:1332     | 51.75963141   | 52.86736594  | 55.83766297  |              | 66.25820998  |  0.61964513  | 58.11194981  | 70.46368003  |
| seed:1330     | 57.87667876   | 60.85677875  | 60.45485737  |              | 69.61082247  |  0.66032742  |  59.4549554  | 72.26742476  |
| seed:1236     | 55.65140672   | 49.07362023  | 71.7380649   |              | 68.88540339  |  0.68424664  | 58.37662974  | 72.26742476  |
| seed:1336     | 60.54308401   | 56.24938731  | 67.42476228  |              | 67.56200373  |  0.68120772  |  60.3960396  | 70.17939418  |
| seed:1337     | 55.39652975   | 59.06283698  | 61.89589256  |              | 64.56229781  |  0.62072346  | 55.40633271  | 74.90442114  |
| seed:1224     | 59.29810803   | 56.71012646  | 61.92530144  |              | 69.76766984  |  0.60513675  | 54.30840114  | 78.66875796  |
| seed:1246     | 56.6513087    | 57.16106264  | 62.06254289  |              | 66.61111656  |  0.61101853  | 58.08254093  |  69.8264876  |
| seed:1227     | 53.64179982   | 55.88667778  | 66.62091952  |              | 66.41505735  |  0.66934614  | 53.26928732  | 62.21939026  |



<center><p>Table7：Indian_pines-2shot-Chikusei</p></center>

| IP-2shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |    CTF-SSCL     |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :-------------: | :----------: | :----------: |
| average OA    | 50.98 ±  3.09 | 51.60 ± 4.53 | 53.78 ± 5.59 | 55.41 ± 3.88 | 60.14 ± 4.84 | 56.82 ± 0.04915 | 53.47 ± 4.82 | 64.81 ± 4.32 |
| average AA    | 63.52 ±  1.86 | 64.12 ± 2.44 | 67.59 ± 3.97 | 70.84 ± 3.51 | 71.40 ± 3.66 |  69.47 ± 2.64   | 64.85 ± 2.81 | 77.63 ± 2.19 |
| average Kappa | 45.19 ±  3.52 | 45.79 ± 5.19 | 48.64 ± 5.91 | 50.88 ± 4.15 | 55.09 ± 5.24 |  51.79 ± 5.26   | 47.91 ± 5.25 | 60.66 ± 4.59 |
| seed:1309     | 55.92639718   | 56.24938827  | 58.12860918  |              | 65.07781149  |   0.60595087    | 56.84643242  |  68.1706959  |
| seed:1310     | 48.00822159   | 47.84183224  | 54.81060977  |              | 65.58676715  |   0.57531565    | 53.51864539  | 63.36497994  |
| seed:1332     | 53.56758344   | 54.38974259  | 53.65567192  |              | 58.4809631   |   0.60193795    | 56.69961828  | 62.76793579  |
| seed:1330     | 51.85475188   | 55.70128218  | 58.60820202  |              | 61.97513947  |   0.56278751    | 59.68483899  | 67.50513849  |
| seed:1236     | 47.42096506   | 45.55153176  | 48.60526573  |              | 55.71106979  |   0.63639033    | 46.04091221  | 57.59029069  |
| seed:1336     | 51.66878732   | 47.34266419  | 65.17568758  |              | 63.33561711  |   0.49075071    | 52.36370755  | 68.00430655  |
| seed:1337     | 54.49740628   | 54.35059215  | 45.02300088  |              | 48.3507879   |   0.52187531    | 55.59361848  | 68.93412939  |
| seed:1224     | 51.61984927   | 58.86267985  | 54.54634433  |              | 61.99471469  |   0.51061956    | 58.47117549  | 71.22442987  |
| seed:1246     | 49.39806205   | 46.94137222  | 50.26915924  |              | 61.46618381  |   0.63629245    | 44.54340805  |  60.3503964  |
| seed:1227     | 45.87452285   | 48.76186748  | 48.98698248  |              | 59.40099834  |   0.54047176    | 50.96407948  | 60.14485661  |



<center><p>Table8：Indian_pines-1shot-Chikusei</p></center>

| IP-1shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |    CTF-SSCL     |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :-------------: | :----------: | :----------: |
| average OA    | 40.93 ±  4.82 | 41.32 ± 5.75 | 42.95 ± 6.74 | 41.65 ± 5.36 | 46.44 ± 5.10 | 43.52 ± 0.04843 | 41.83 ± 5.51 | 52.16 ± 4.48 |
| average AA    | 52.23 ±  3.77 | 49.53 ± 2.39 | 54.60 ± 6.55 | 60.48 ± 4.77 | 58.26 ± 5.25 |  57.84 ± 3.69   | 49.55 ± 3.60 | 65.16 ± 3.25 |
| average Kappa | 34.15 ±  5.09 | 34.41 ± 5.95 | 36.32 ± 7.24 | 36.46 ± 5.58 | 39.76 ± 5.68 |  37.59 ± 4.95   | 35.06 ± 5.77 | 46.66 ± 4.58 |
| seed:1309     | 46.2132317    | 46.07641943  | 50.49350142  |              | 51.27528584  |   0.41590931    | 46.06664712  | 50.71826444  |
| seed:1310     | 40.6625623    |  40.1153132  | 39.76351021  |              | 47.66930519  |   0.52633636    |  42.1381804  | 48.27518812  |
| seed:1332     | 46.69207466   | 49.75080622  | 55.35033714  |              | 50.75735366  |   0.46047103    | 47.45431447  | 53.25906381  |
| seed:1330     | 41.18049448   | 37.42792925  | 38.53219975  |              | 51.05052282  |   0.41600704    |  39.5485195  | 52.87794391  |
| seed:1236     | 36.85136324   | 38.35629825  | 38.18039676  |              | 37.68200919  |   0.49526043    | 37.65269227  | 46.04710251  |
| seed:1336     | 32.75676732   | 34.55487149  | 45.4803088   |              | 45.43144728  |   0.40965504    | 38.88400274  | 55.10602951  |
| seed:1337     | 37.23248314   | 36.28456953  | 36.90022476  |              | 38.98172579  |   0.35756865    | 35.59073585  | 44.68875208  |
| seed:1224     | 44.64966286   | 47.49340369  | 40.78960227  |              | 48.38268348  |   0.46867976    | 48.44131731  | 53.93335288  |
| seed:1246     | 46.96569921   | 48.70516955  | 50.39577836  |              | 51.95934721  |   0.39587609    | 49.61399394  | 58.62405942  |
| seed:1227     | 36.06957881   | 34.39851461  | 33.56786866  |              | 41.20981139  |   0.40662562    | 32.94244112  |  58.0474934  |



<center><p>Table9：Salinas-5shot-Chikusei</p></center>

| SA-5shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL    |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :-----------: | :----------: | :----------: |
| average OA    | 89.74 ±  1.26 | 90.12 ± 1.22 | 89.14 ± 2.09 | 91.08 ± 2.39 | 90.96 ± 2.06 | 89.96 ± 1.428 | 89.94 ± 1.30 | 93.15 ± 1.00 |
| average AA    | 93.93 ±  0.84 | 94.30 ± 0.60 | 94.05 ± 1.49 | 95.14 ± 1.09 | 95.59 ± 1.09 | 94.29 ± 0.99  | 93.89 ± 0.96 | 95.99 ± 0.50 |
| average Kappa | 88.59 ±  1.39 | 89.01 ± 1.35 | 87.93 ± 2.31 | 90.11 ± 2.62 | 89.96 ± 2.26 | 88.86 ± 1.57  | 88.81 ± 1.44 |  92.38±1.10  |
| seed:1309     | 91.19687691   | 91.37079317  | 89.4780662   | 0.87872116   | 90.86939629  |  0.90934152   | 88.84715721  |  94.1090492  |
| seed:1310     | 88.09228663   | 87.12094581  | 89.65753298  | 0.918832911  | 88.9026624   |  0.90007216   | 87.50023127  | 93.20246443  |
| seed:1332     | 91.35229144   | 91.28383504  | 86.93407834  | 0.853059261  | 87.39662158  |   0.9048641   | 90.66957761  | 94.44578068  |
| seed:1330     | 90.66402709   |  89.7722437  | 86.76201225  | 0.9272697    | 90.7454347   |  0.91159873   | 90.47715961  | 92.36988658  |
| seed:1236     | 90.7176821    | 90.99150771  | 89.01552295  | 0.923051305  | 93.43003571  |  0.91709375   | 91.41149697  | 92.48644748  |
| seed:1336     | 87.70560047   | 89.76484301  | 86.2310126   | 0.918888416  | 91.96654887  |  0.90434606   | 88.58998316  | 92.87313364  |
| seed:1337     | 89.69453644   | 90.65477622  | 93.29497308  | 0.910858665  | 93.68165924  |   0.8962608   | 91.23388037  | 93.50404263  |
| seed:1224     | 90.09602398   |  89.2930489  | 91.7796814   | 0.919387963  | 92.42724195  |  0.86247664   | 88.86380877  | 90.87124646  |
| seed:1246     | 88.19959666   | 89.82219838  | 89.37075617  | 0.933319765  | 88.20514718  |  0.89785195   |  90.6769783  | 93.84262429  |
| seed:1227     | 89.7037873    | 91.11361912  | 88.89711188  | 0.924938482  | 91.99615164  |  0.89244944   | 91.15432293  | 93.80192048  |



<center><p>Table10：Salinas-4shot-Chikusei</p></center>

| SA-4shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL   |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :----------: | :----------: | :----------: |
| average OA    | 88.61 ±  1.53 | 88.05 ± 1.90 | 86.98 ± 2.57 | 90.04 ± 2.03 | 88.11 ± 3.66 | 88.58 ± 1.59 | 89.04 ± 1.50 | 91.83 ± 1.09 |
| average AA    | 92.81 ±  1.09 | 92.77 ± 1.11 | 92.65 ± 1.27 | 94.31 ± 1.16 | 94.44 ± 1.09 | 92.75 ± 1.18 | 93.04 ± 1.14 | 95.10 ± 0.84 |
| average Kappa | 87.31 ±  1.70 | 86.72 ± 2.09 | 85.56 ± 2.84 | 88.95 ± 2.23 | 86.83 ± 3.99 | 87.33 ± 1.75 | 87.81 ± 1.66 |  90.91±1.22  |
| seed:1309     | 89.28696939   | 88.96513456  | 87.85720892  |              | 90.23212799  |  0.91332655  | 89.71793212  | 92.93443078  |
| seed:1310     | 87.70923888   | 87.32821604  | 81.63321927  |              | 81.83297882  |  0.87805419  | 89.93063905  | 91.63784334  |
| seed:1332     | 90.75187275   | 91.27346712  | 86.133358    |              | 91.15509109  |  0.87370757  |  90.9812263  | 93.07685194  |
| seed:1330     | 90.1451956    | 89.32951077  | 86.52547859  |              | 86.61611024  |  0.91502821  | 90.87579765  | 91.02931656  |
| seed:1236     | 88.4157958    | 87.94229169  | 85.11236475  |              | 81.29103856  |  0.87809119  | 89.64579673  | 90.45963192  |
| seed:1336     | 87.86275779   | 87.52242671  | 88.29741977  |              | 91.48617405  |  0.88282623  | 88.38990105  | 91.42883566  |
| seed:1337     | 90.60760196   |  89.9343383  | 91.78396375  |              | 92.00036993  |  0.88210487  | 89.76972163  | 91.35115139  |
| seed:1224     | 85.96874133   | 85.37501156  | 89.53666882  |              | 88.43799131  |  0.86647554  | 86.46444095  | 90.23767687  |
| seed:1246     | 86.73078702   |  84.6148155  | 86.04827522  |              | 87.65929899  |  0.8957921   | 86.85656155  | 92.51271617  |
| seed:1227     | 88.57301396   | 88.21788588  | 86.85656155  |              | 90.3412559   |  0.87278276  |  87.8128179  | 93.62434107  |



<center><p>Table11：Salinas-3shot-Chikusei</p></center>

| SA-3shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL   |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :----------: | :----------: | :----------: |
| average OA    | 84.99 ±  1.53 | 84.88 ± 1.84 | 85.28 ± 2.65 | 87.48 ± 3.23 | 84.33 ± 3.52 | 85.57 ± 2.17 | 85.37 ± 2.01 | 90.70 ± 1.86 |
| average AA    | 90.85 ±  1.22 | 90.74 ± 1.56 | 91.24 ± 1.82 | 92.21 ± 2.03 | 91.94 ± 1.33 | 90.99 ± 1.43 | 90.41 ± 1.98 | 94.03 ± 1.28 |
| average Kappa | 83.36 ±  1.67 | 83.23 ± 2.00 | 83.63 ± 2.93 | 86.14 ± 3.55 | 82.66 ± 3.84 | 84.01 ± 2.38 | 83.75 ± 2.22 |  89.66±2.06  |
| seed:1309     | 87.67774265   | 87.65555371  | 83.2214641   |              | 88.22691888  |  0.89345611  | 87.70547882  |  92.8810488  |
| seed:1310     | 83.18633161   | 81.42231098  | 80.05584216  |              | 78.22340563  |  0.87775744  | 83.73550785  | 92.39474122  |
| seed:1332     | 85.79907916   | 85.97289251  | 87.01392356  |              | 84.81906769  |  0.83918567  | 88.84081285  |  91.538618   |
| seed:1330     | 86.96399845   |  86.764298   | 84.65080158  |              | 85.14450546  |  0.8471367   |  86.6958821  | 90.14256393  |
| seed:1236     | 85.71587064   | 84.58608384  | 85.01506999  |              | 84.44185573  |  0.85641908  | 83.53026017  | 88.80937852  |
| seed:1336     | 85.1075239    |  86.4665964  | 89.24761007  |              | 90.16475287  |  0.84872691  | 85.45884876  | 90.52532313  |
| seed:1337     | 84.63785803   | 84.97254119  | 88.2934857   |              | 82.45409663  |  0.84621216  | 87.11192471  | 91.26310534  |
| seed:1224     | 83.7909802    | 84.81536954  | 82.91266803  |              | 86.24655609  |  0.8475435   | 84.62676356  | 87.30977608  |
| seed:1246     | 82.55949409   | 83.29912539  | 84.89857806  |              | 78.92420628  |  0.88339713  | 83.39342838  | 88.82786931  |
| seed:1227     | 84.48253546   | 82.81651597  | 87.45770234  |              | 84.70442484  |  0.81683031  | 82.65009893  | 93.32112942  |



<center><p>Table12：Salinas-2shot-Chikusei</p></center>

| SA-2shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL   |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :----------: | :----------: | :----------: |
| average OA    | 82.16 ±  2.64 | 82.04 ± 3.26 | 80.18 ± 2.76 | 84.89 ± 3.23 | 81.40 ± 2.99 | 81.79 ± 3.26 | 81.63 ± 2.86 | 87.55 ± 3.13 |
| average AA    | 88.44 ±  1.42 | 88.56 ± 1.82 | 86.30 ± 2.13 | 88.77 ± 2.15 | 86.53 ± 3.45 | 87.78 ± 2.22 | 87.83 ± 1.66 | 91.91 ± 1.74 |
| average Kappa | 80.23 ±  2.90 | 80.10 ± 3.58 | 77.96 ± 2.92 | 83.27 ± 3.53 | 79.34 ± 3.27 | 79.85 ± 3.56 | 79.62 ± 3.16 |  86.17±3.45  |
| seed:1309     | 83.90298908   | 86.43362848  | 81.14867738  |              | 82.97687487  |  0.82588683  | 85.03613879  | 86.98449082  |
| seed:1310     | 82.75505111   | 77.72889439  | 73.4532414   |              | 75.09658576  |  0.83854927  | 79.47390798  | 84.79028412  |
| seed:1332     | 85.58884966   | 84.48712498  | 77.07266577  |              | 82.40567869  |  0.77536647  | 82.49995379  | 91.52633233  |
| seed:1330     | 78.76592048   | 78.91380298  | 83.6331035   |              | 83.26709429  |  0.83100726  | 82.60347154  | 90.43569884  |
| seed:1236     | 86.699817     | 87.43922953  | 82.0230327   |              | 86.55378302  |  0.84350334  | 85.44466421  | 90.53551953  |
| seed:1336     | 77.95441522   | 78.64576594  | 80.30205002  |              | 79.88428194  |  0.86097196  | 77.43312938  | 80.49244875  |
| seed:1337     | 82.54062148   |  84.4945191  | 79.86764516  |              | 81.43704827  |  0.7812448   | 84.07675102  | 86.85879069  |
| seed:1224     | 82.09142836   | 81.34647023  | 81.12464647  |              | 80.5368135   |  0.82180158  | 83.25970017  | 86.41884023  |
| seed:1246     | 80.3482633    |  80.2299573  | 81.4980498   |              | 78.44427602  |  0.84298575  | 78.45536721  | 89.86265412  |
| seed:1227     | 80.96382424   | 80.64033126  | 81.71802503  |              | 83.43161358  |  0.75738026  | 78.06347857  | 87.54829288  |



<center><p>Table13：Salinas-1shot-Chikusei</p></center>

| SA-1shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL   |     MLPA     |    FGAPA     |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :----------: | :----------: | :----------: |
| average OA    | 75.65 ±  2.46 | 74.81 ± 4.12 | 68.41 ± 4.76 | 76.77 ± 5.72 | 68.30 ± 4.83 | 74.19 ± 3.14 | 73.37 ± 3.08 | 79.47± 3.30  |
| average AA    | 82.45 ±  2.95 | 81.46 ± 3.97 | 73.29 ± 3.15 | 80.52 ± 3.67 | 72.46 ± 3.76 | 80.68 ± 3.59 | 79.90 ± 3.22 | 86.82 ± 1.55 |
| average Kappa | 73.06 ±  2.68 | 72.16 ± 4.53 | 65.10 ± 5.05 | 74.40 ± 6.13 | 64.96 ± 5.03 | 71.58 ± 3.38 | 70.57 ± 3.44 |  77.31±3.54  |
| seed:1309     | 79.52987267   | 80.22841092  | 71.26568477  |              | 71.41906751  |  0.72485355  | 75.98174191  | 84.01862769  |
| seed:1310     | 73.24118049   | 72.60362575  | 67.69907416  |              | 67.51612367  |   0.771663   | 70.71498531  | 73.57566574  |
| seed:1332     | 76.78007133   | 79.19169146  | 66.83791326  |              | 64.45216491  |  0.72416979  | 79.23973906  | 81.70679874  |
| seed:1330     | 73.93047881   | 72.02890248  | 68.49001164  |              | 70.07188661  |  0.76547225  | 71.42461146  | 80.79759023  |
| seed:1236     | 79.67401549   | 80.99162863  | 72.8401678   |              | 68.46783583  |  0.72407739  | 76.65995232  | 84.41224844  |
| seed:1336     | 72.0991259    | 67.44220428  | 59.33324709  |              | 61.33091863  |  0.81422209  | 69.49716334  | 77.83896661  |
| seed:1337     | 75.96326206   | 76.39199453  | 72.7182008   |              | 72.31718811  |  0.70101454  | 69.77990501  | 79.59640013  |
| seed:1224     | 73.79187995   | 71.86627982  | 72.7182008   |              | 70.11623824  |  0.71788664  | 72.11575777  | 75.63247279  |
| seed:1246     | 76.95747787   | 74.87110306  | 60.37920648  |              | 60.39214237  |  0.73557186  | 74.96719827  | 77.30120304  |
| seed:1227     | 74.55324968   |  72.5241624  | 71.82562416  |              | 76.94084601  |  0.74028422  | 73.34651562  |  79.7941345  |

**Botswana-5shot**

<center><p>Table14：Botswana-5shot-Chikusei</p></center>

| BW-5shot      | DFSL+NN        |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL    |     MLPA     |    FGAPA     |
| ------------- | -------------- | :----------: | ------------ | ------------ | ------------ | :-----------: | :----------: | :----------: |
| average OA    | 96.48 +-  0.84 | 96.90 ± 1.03 | 94.56 ± 1.61 | 92.55 ± 1.79 | 95.81 ± 1.43 | 96.05 +- 1.32 | 96.65 ± 1.04 | 98.22 ± 1.31 |
| average AA    | 96.58 +-  0.83 | 97.02 ± 1.13 | 94.77 ± 1.33 | 93.32 ± 1.76 | 95.58 ± 1.46 | 96.04 +- 1.41 | 96.74 ± 1.08 | 98.23 ± 1.36 |
| average Kappa | 96.18+-  0.90  | 96.63 ± 1.12 | 94.10 ± 1.73 | 91.93 ± 1.94 | 95.45 ± 1.55 | 95.71 +- 1.43 | 96.37 ± 1.12 | 98.07 ±1.42  |
| seed:1309     | 97.07363121    | 96.53870359  | 96.47577093  | 0.932976715  | 93.6123348   |  0.96633103   | 94.02139711  | 98.30081812  |
| seed:1310     | 97.07363121    | 97.54562618  | 94.87098804  | 0.951227187  | 96.09817495  |   0.9845815   | 97.19949654  | 99.43360604  |
| seed:1332     | 97.01069855    | 96.06670862  | 93.14033984  | 0.942731278  | 93.92699811  |  0.94430459   | 97.32536186  | 96.69603524  |
| seed:1330     | 95.28005035    | 95.56324733  | 94.39899308  | 0.935179358  | 93.76966646  |   0.9408433   |  96.8533669  | 95.50031466  |
| seed:1236     | 97.57709251    | 98.23788546  | 95.68911265  | 0.887665198  | 96.8533669   |  0.97073631   | 96.00377596  | 99.30774072  |
| seed:1336     | 96.97923222    | 95.75204531  | 94.87098804  | 0.912838263  | 95.56324733  |  0.95342983   | 98.04908748  | 96.88483323  |
| seed:1337     | 96.00377596    | 96.09817495  | 94.1157961   | 0.935808685  | 97.45122719  |  0.96475771   | 96.50723726  | 98.74134676  |
| seed:1224     | 94.83952171    |  96.8533669  | 90.59156702  | 0.90874764   | 96.57016992  |  0.95563247   | 96.63310258  | 98.61548143  |
| seed:1246     | 96.82190057    | 98.77281309  | 95.8464443   | 0.931718062  | 97.13656388  |  0.97419761   | 96.47577093  | 99.43360604  |
| seed:1227     | 96.09817495    | 97.54562618  | 95.59471366  | 0.916299559  | 97.10509755  |  0.94996853   | 97.45122719  | 99.24480806  |



<center><p>Table15：Botswana-4shot-Chikusei</p></center>

| BW-4shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL    |     MLPA     |    FGAPA    |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :-----------: | :----------: | :---------: |
| average OA    | 95.54 ±  1.46 | 95.98 ± 1.23 | 94.19 ± 2.49 | 88.82 ± 2.46 | 93.32 ± 2.36 | 94.93 +- 0.85 | 95.30 ± 1.34 | 97.16 ±1.35 |
| average AA    | 95.67 ±  1.40 | 96.13 ± 1.09 | 94.51 ± 1.97 | 89.49 ± 2.14 | 93.57 ± 2.28 | 94.94 +- 0.93 | 95.49 ± 1.20 | 97.21± 1.27 |
| average Kappa | 95.16 ±  1.58 | 95.64 ± 1.33 | 93.71 ± 2.69 | 87.89 ± 2.66 | 92.76 ± 2.54 | 94.50 +- 0.92 | 94.90 ± 1.44 | 96.93 ±1.47 |
| seed:1309     | 96.86716792   | 96.96115288  | 89.78696742  |              | 88.34586466  |  0.93640351   | 95.77067669  | 97.65037594 |
| seed:1310     | 95.42606516   | 96.89849624  | 93.6716792   |              | 91.66666667  |  0.96177945   | 95.98997494  | 97.71303258 |
| seed:1332     | 95.86466165   | 96.05263158  | 93.85964912  |              | 92.66917293  |  0.95582707   |  94.5802005  | 96.17794486 |
| seed:1330     | 95.83333333   | 96.05263158  | 95.98997494  |              | 94.23558897  |  0.95175439   | 95.39473684  | 95.70802005 |
| seed:1236     | 97.08646617   | 97.68170426  | 96.80451128  |              | 97.7443609   |  0.94360902   | 93.70300752  | 98.08897243 |
| seed:1336     | 93.23308271   | 93.04511278  | 89.7556391   |              | 92.41854637  |  0.94486216   | 97.33709273  | 96.86716792 |
| seed:1337     | 94.98746867   | 94.95614035  | 96.74185464  |              | 94.48621554  |   0.9608396   | 93.45238095  | 98.40225564 |
| seed:1224     | 95.55137845   | 95.39473684  | 93.85964912  |              | 94.26691729  |  0.95551378   | 95.77067669  | 98.27694236 |
| seed:1246     | 97.65037594   | 96.67919799  | 94.92481203  |              | 95.08145363  |  0.94298246   | 93.73433584  | 98.59022556 |
| seed:1227     | 92.9197995    |  96.0839599  | 96.52255639  |              | 92.3245614   |  0.93953634   | 97.27443609  | 94.17293233 |



<center><p>Table16：Botswana-3shot-Chikusei</p></center>

| BW-3shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL    |     MLPA     |    FGAPA    |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :-----------: | :----------: | :---------: |
| average OA    | 94.44 ±  1.94 | 94.67 ± 1.36 | 88.83 ± 3.45 | 86.91 ± 1.93 | 90.19 ± 3.24 | 93.31 +- 1.65 | 94.42 ± 1.98 | 96.90 ±1.31 |
| average AA    | 94.67 ±  1.64 | 94.83 ± 1.04 | 89.78 ± 2.78 | 87.86 ± 1.64 | 90.44 ± 2.96 | 93.50 +- 1.48 | 94.82 ± 1.69 | 96.95±1.21  |
| average Kappa | 93.97 ±  2.10 | 94.22 ± 1.47 | 87.91 ± 3.72 | 85.83 ± 2.08 | 89.37 ± 3.50 | 92.75 +- 1.79 | 93.95 ± 2.13 | 96.64 ±1.42 |
| seed:1309     | 92.85714286   | 93.94884591  | 83.03181535  |              | 85.65190268  |  0.91703057   | 92.88833437  | 96.63131628 |
| seed:1310     | 95.25888958   | 94.66625078  | 84.46662508  |              | 84.68496569  |  0.95134124   | 91.23518403  | 98.12850905 |
| seed:1332     | 97.19276357   | 95.00935745  | 91.79663132  |              | 91.20399251  |  0.95446039   | 92.29569557  | 96.63131628 |
| seed:1330     | 92.79475983   | 93.51216469  | 89.33250156  |              | 87.77292576  |  0.94198378   | 95.53961323  | 96.91203993 |
| seed:1236     | 95.85152838   | 95.47723019  | 92.66999376  |              | 94.54148472  |   0.9176544   | 92.66999376  | 98.47161572 |
| seed:1336     | 90.33063007   | 91.32875858  | 86.4628821   |              | 91.20399251  |  0.92326887   | 97.09918902  | 96.41297567 |
| seed:1337     | 95.04054897   | 95.60199626  | 92.07735496  |              | 93.82407985  |  0.95851528   | 94.79101684  | 97.19276357 |
| seed:1224     | 94.07361198   | 95.07174049  | 88.89582034  |              | 91.07922645  |  0.92857143   | 94.82220836  | 95.13412352 |
| seed:1246     | 96.6625078    | 95.82033687  | 93.29382408  |              | 93.44978166  |  0.92981909   | 95.38365565  | 98.93948846 |
| seed:1227     | 94.3231441    | 96.22582658  | 86.275733    |              | 88.49033063  |  0.90829694   | 97.47348721  | 94.54148472 |



<center><p>Table17：Botswana-2shot-Chikusei</p></center>

| BW-2shot      | DFSL+NN       |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL    |     MLPA     |    FGAPA    |
| ------------- | ------------- | :----------: | ------------ | ------------ | ------------ | :-----------: | :----------: | :---------: |
| average OA    | 91.64 ±  2.69 | 92.79 ± 1.92 | 82.84 ± 3.75 | 81.07 ± 3.70 | 81.55 ± 3.14 | 89.67 +- 3.57 | 92.63 ± 1.55 | 94.95 ±2.15 |
| average AA    | 92.05 ±  2.59 | 93.10 ± 1.84 | 84.21 ± 3.43 | 81.55 ± 3.80 | 82.36 ± 2.80 | 90.33 +- 3.41 | 92.79 ± 1.74 | 95.22±2.05  |
| average Kappa | 90.94 ±  2.90 | 92.19 ± 2.07 | 81.44 ± 4.02 | 79.50 ± 4.01 | 80.02 ± 3.37 | 88.82 +- 3.86 | 92.01 ± 1.67 | 94.53 ±2.33 |
| seed:1309     | 92.26708075   | 91.95652174  | 80.55900621  |              | 78.44720497  |  0.92236025   | 93.50931677  | 96.21118012 |
| seed:1310     | 86.98757764   | 90.83850932  | 83.32298137  |              | 80.83850932  |  0.94782609   | 91.89440994  | 96.39751553 |
| seed:1332     | 91.92546584   | 93.54037267  | 87.36024845  |              | 85.74534161  |  0.86521739   | 91.24223602  | 93.81987578 |
| seed:1330     | 92.67080745   | 91.18012422  | 82.60869565  |              | 81.61490683  |  0.87546584   | 93.22981366  | 95.62111801 |
| seed:1236     | 94.56521739   | 94.09937888  | 86.73913043  |              | 84.00621118  |  0.86304348   | 90.62111801  | 96.98757764 |
| seed:1336     | 88.35403727   | 92.04968944  | 85.31055901  |              | 75.80745342  |   0.8673913   | 94.53416149  | 94.34782609 |
| seed:1337     | 93.32298137   |  95.0310559  | 86.52173913  |              | 84.09937888  |  0.93478261   | 91.24223602  | 96.45962733 |
| seed:1224     | 88.63354037   | 89.47204969  | 76.64596273  |              | 80.40372671  |   0.8447205   | 94.65838509  | 94.00621118 |
| seed:1246     | 95.86956522   | 95.96273292  | 76.42857143  |              | 85.65217391  |  0.93881988   | 90.83850932  | 96.27329193 |
| seed:1227     | 91.77018634   | 93.78881988  | 82.88819876  |              | 78.85093168  |  0.90776398   | 94.50310559  | 89.34782609 |

**Botswana-1shot**

<center><p>Table18：Botswana-1shot-Chikusei</p></center>

| BW-1shot      | DFSL+NN        |    DCFSL     | HFSL         | DM-MRN       | FSCF-SSL     |   CTF-SSCL    |     MLPA     |    FGAPA    |
| ------------- | -------------- | :----------: | ------------ | ------------ | ------------ | :-----------: | :----------: | :---------: |
| average OA    | 86.88 +-  3.37 | 85.14 ± 2.96 | 68.85 ± 5.00 | 59.91 ± 4.66 | 68.76 ± 4.89 | 79.20 +- 3.64 | 82.72 ± 2.81 | 90.62 ±1.71 |
| average AA    | 87.52 +-  2.97 | 85.74 ± 2.29 | 70.19 ± 4.63 | 61.64 ± 4.05 | 70.22 ± 4.92 | 80.80 +- 3.36 | 83.23 ± 2.72 | 91.01±1.82  |
| average Kappa | 85.80 +-  3.64 | 83.92 ± 3.19 | 66.33 ± 5.37 | 56.66 ± 5.01 | 66.21 ± 5.27 | 77.50 +- 3.93 | 81.29 ± 3.04 | 89.85 ±1.85 |
| seed:1309     | 88.86827458    | 87.87878788  | 66.57390229  |              | 68.76932591  |  0.76345083   | 79.87012987  | 89.20841064 |
| seed:1310     | 82.12739641    | 82.71490414  | 69.66604824  |              | 58.71985158  |  0.77860235   | 82.28200371  | 88.65182437 |
| seed:1332     | 90.2288188     | 86.85837972  | 80.33395176  |              | 67.53246753  |   0.7585034   | 80.82869511  | 88.71366729 |
| seed:1330     | 87.69325912    | 85.93073593  | 73.09833024  |              | 70.16079159  |  0.84570192   | 78.35497835  | 91.15646259 |
| seed:1236     | 84.44650588    | 87.38404453  | 70.40816327  |              | 74.21150278  |  0.80983302   | 85.93073593  | 90.32158318 |
| seed:1336     | 88.18800247    | 84.69387755  | 70.5318491   |              | 66.32653061  |  0.78849722   | 83.48794063  | 90.78540507 |
| seed:1337     | 82.40568955    |  78.1694496  | 64.31663575  |              | 77.05627706  |  0.75108225   | 88.28076685  | 94.68150897 |
| seed:1224     | 90.63079777    | 85.15769944  | 61.81199753  |              | 70.56277056  |  0.79128015   |  84.1991342  | 91.03277675 |
| seed:1246     | 83.0550402     | 83.67346939  | 64.93506494  |              | 70.47000618  |  0.76592455   |  83.2096475  | 89.70315399 |
| seed:1227     | 91.18738404    | 88.96103896  | 66.85219542  |              | 63.82189239  |  0.86703772   | 80.73593074  | 91.99134199 |



## 消融实验(to Reviewer 1702，1178)

<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251218161210612.png" alt="替代文本" title="图片标题" width=1000>

<center><p>Fig8：ablation experiment</p></center>

- **Module Ablation**

  <center><p>Table19：module ablation on IP</p></center>

  | IP-5shot      |   only FSL    |   FSL+ACA    |    FGAPA     |
  | ------------- | :-----------: | :----------: | :----------: |
  | average OA    | 76.89 ±  2.30 | 78.71 ± 2.61 | 79.65 ± 2.76 |
  | average AA    | 86.09 ±  1.18 | 87.02 ± 1.75 | 87.74 ± 1.37 |
  | average Kappa | 73.94  ± 2.45 | 75.87 ± 2.94 | 77.01 ± 3.27 |
  | seed:1309     |  77.29373586  | 82.31881208  |  83.8233848  |
  | seed:1310     |  76.81187924  | 79.80135707  | 83.29235913  |
  | seed:1332     |  76.29068738  | 77.52974727  | 76.58570164  |
  | seed:1330     |  78.11977579  | 76.70370735  | 75.43514603  |
  | seed:1236     |  79.67351755  | 82.41715016  |  81.6599469  |
  | seed:1336     |  72.40633297  | 74.74677943  | 74.79594847  |
  | seed:1337     |  80.55856033  | 81.80745403  | 81.72878356  |
  | seed:1224     |  76.07434359  | 77.54941489  |  80.7552365  |
  | seed:1246     |  73.99940997  | 75.86783361  |  76.4283607  |
  | seed:1227     |  77.6772544   | 78.32628577  | 81.97462877  |



<center><p>Table20：module ablation on SA</p></center>

| SA-5shot      |   only FSL    |   FSL+ACA    |    FGAPA     |
| ------------- | :-----------: | :----------: | :----------: |
| average OA    | 91.80 ±  1.21 | 92.74 ± 0.92 | 93.15 ± 1.00 |
| average AA    | 95.45 ±  0.61 | 95.85 ± 0.56 | 95.99 ± 0.50 |
| average Kappa | 90.88  ± 1.34 | 91.92 ± 1.02 |  92.38±1.10  |
| seed:1309     |  91.12842051  | 92.79727655  |  94.1090492  |
| seed:1310     |  92.42539177  | 93.52809488  | 93.20246443  |
| seed:1332     |  93.56139799  | 94.12755093  | 94.44578068  |
| seed:1330     |  92.46424541  | 91.88514126  | 92.36988658  |
| seed:1236     |  91.39114507  | 91.57986272  | 92.48644748  |
| seed:1336     |   89.176488   | 91.83333642  | 92.87313364  |
| seed:1337     |  92.15711669  | 93.85372532  | 93.50404263  |
| seed:1224     |  90.47900979  | 91.55025995  | 90.87124646  |
| seed:1246     |  92.86388277  | 93.19506374  | 93.84262429  |
| seed:1227     |  92.35693537  |  93.026698   | 93.80192048  |



<center><p>Table21：module ablation on BW</p></center>

| BW-5shot      |   only FSL    |   FSL+ACA    |    FGAPA     |
| ------------- | :-----------: | :----------: | :----------: |
| average OA    | 97.63 ±  1.38 | 98.16 ± 1.08 | 98.22 ± 1.31 |
| average AA    | 97.50 ±  1.51 | 98.09 ± 1.17 | 98.23 ± 1.36 |
| average Kappa | 97.43  ± 1.50 | 98.01 ± 1.17 |  98.07±1.42  |
| seed:1309     |  97.04216488  | 97.35682819  | 98.30081812  |
| seed:1310     |  99.15040906  | 99.27627439  | 99.43360604  |
| seed:1332     |  97.2624292   | 96.47577093  | 96.69603524  |
| seed:1330     |  94.77658905  | 96.41283826  | 95.50031466  |
| seed:1236     |  98.86721208  | 98.99307741  | 99.30774072  |
| seed:1336     |  96.3499056   | 97.57709251  | 96.88483323  |
| seed:1337     |  98.83574575  |  98.5840151  | 98.74134676  |
| seed:1224     |  98.55254877  | 98.39521712  | 98.61548143  |
| seed:1246     |  98.89867841  | 99.37067338  | 99.43360604  |
| seed:1227     |  96.57016992  | 99.18187539  | 99.24480806  |



- **Loss Ablation**

  <center><p>Table22：loss ablation on IP</p></center>

| IP-5shot      |     L_fsl     |  L_fsl+L_in  | L_fsl+L_cross |    FGAPA     |
| ------------- | :-----------: | :----------: | :-----------: | :----------: |
| average OA    | 78.28 ±  1.40 | 77.72 ± 2.32 | 78.69 ± 3.11  | 79.65 ± 2.76 |
| average AA    | 86.86 ±  1.45 | 86.16 ± 1.55 | 87.37 ± 1.86  | 87.74 ± 1.37 |
| average Kappa | 75.47  ± 1.62 | 74.79 ± 2.64 | 75.94 ± 3.45  | 77.01 ± 3.27 |
| seed:1309     |  80.44055463  | 79.53584423  |  80.25371226  |  83.8233848  |
| seed:1310     |  79.32933425  | 81.90579211  |  81.73861737  | 83.29235913  |
| seed:1332     |  78.27711673  | 77.19539778  |  78.72947192  | 76.58570164  |
| seed:1330     |  76.40869309  | 74.06824663  |  75.50398269  | 75.43514603  |
| seed:1236     |  78.94581571  | 76.89054971  |  81.3255974   |  81.6599469  |
| seed:1336     |  76.91021733  |  76.310355   |  72.33749631  | 74.79594847  |
| seed:1337     |   79.496509   | 77.92309962  |  82.31881208  | 81.72878356  |
| seed:1224     |  79.53584423  | 80.28321369  |  81.02074934  |  80.7552365  |
| seed:1246     |  76.49719736  | 74.63860753  |  75.77932933  |  76.4283607  |
| seed:1227     |  76.92988494  | 78.41479005  |   77.903432   | 81.97462877  |



<center><p>Table23：loss ablation on SA</p></center>

| SA-5shot      |     L_fsl     |  L_fsl+L_in  | L_fsl+L_cross |    FGAPA     |
| ------------- | :-----------: | :----------: | :-----------: | :----------: |
| average OA    | 92.28 ±  0.93 | 91.76 ± 1.17 | 92.13 ± 0.81  | 93.15 ± 1.00 |
| average AA    | 95.71 ±  0.47 | 95.29 ± 0.56 | 95.70 ± 0.47  | 95.99 ± 0.50 |
| average Kappa | 91.41  ± 1.04 | 90.83 ± 1.29 | 91.25 ± 0.89  |  92.38±1.10  |
| seed:1309     |  93.42633536  | 92.75102222  |  93.27832152  |  94.1090492  |
| seed:1310     |  91.60021462  |  91.3615423  |  91.97209939  | 93.20246443  |
| seed:1332     |  94.04244297  | 92.77507447  |  92.89903606  | 94.44578068  |
| seed:1330     |  91.98320043  | 92.49384817  |  91.78338175  | 92.36988658  |
| seed:1236     |  91.58356306  | 91.67977206  |  91.6834724   | 92.48644748  |
| seed:1336     |  91.79633296  | 89.10618143  |  90.98410701  | 92.87313364  |
| seed:1337     |  91.96839905  | 92.34398416  |  91.88329109  | 93.50404263  |
| seed:1224     |  91.01000944  | 90.54191567  |  90.90639975  | 90.87124646  |
| seed:1246     |  93.40228311  |  93.1636108  |  93.05630076  | 93.84262429  |
| seed:1227     |  92.00910285  | 91.37264334  |  92.84723122  | 93.80192048  |



<center><p>Table24：loss ablation on BW</p></center>

| BW-5shot      |     L_fsl     |  L_fsl+L_in  | L_fsl+L_cross |    FGAPA     |
| ------------- | :-----------: | :----------: | :-----------: | :----------: |
| average OA    | 97.87 ±  1.28 | 98.18 ± 0.98 | 98.16 ± 1.08  | 98.22 ± 1.31 |
| average AA    | 97.87 ±  1.26 | 98.11 ± 1.12 | 98.09 ± 1.17  | 98.23 ± 1.36 |
| average Kappa | 97.69  ± 1.38 | 98.03 ± 1.07 | 98.01 ± 1.17  | 98.07 ±1.42  |
| seed:1309     |  98.01762115  | 97.23096287  |  97.35682819  | 98.30081812  |
| seed:1310     |  99.62240403  | 99.68533669  |  99.27627439  | 99.43360604  |
| seed:1332     |  96.69603524  |  96.8533669  |  96.47577093  | 96.69603524  |
| seed:1330     |  94.65072373  |  96.8533669  |  96.41283826  | 95.50031466  |
| seed:1236     |  98.42668345  | 99.05601007  |  98.99307741  | 99.30774072  |
| seed:1336     |  98.14348647  | 97.98615481  |  97.57709251  | 96.88483323  |
| seed:1337     |  98.48961611  | 98.70988043  |  98.5840151   | 98.74134676  |
| seed:1224     |  97.98615481  | 97.45122719  |  98.39521712  | 98.61548143  |
| seed:1246     |  98.6784141   | 99.15040906  |  99.37067338  | 99.43360604  |
| seed:1227     |  97.95468848  | 98.83574575  |  99.18187539  | 99.24480806  |

## 关于论文图片(to Reviewer 1178 Q17)

由于论文篇幅的限制，图片无法跨栏显示而带来的清晰度不足，为此深感抱歉。我们会在最终版本替换为更加清晰的图片。

<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/perfomence.png" alt="替代文本" title="图片标题" width=1000>

<center><p>Fig9：OA values using 1-5 labeled samples</p></center>

## Classification map

**Indian_pines**

<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251217172136688.png" alt="替代文本" title="图片标题" width=1000>

<center><p>Fig10：Classificationmaps of IP dataset.</p></center>

**Salinas**

<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251217173401459.png" alt="替代文本" title="图片标题" width=1000>

<center><p>Fig11：Classificationmaps of SA dataset.</p></center>

**Botswana**

<img src="https://gitee.com/abcd123123410513/images/raw/master/imgs/image-20251217174530160.png" alt="替代文本" title="图片标题" width=1000>

<center><p>Fig12：Classificationmaps of BW dataset.</p></center>

## **ending**(to Reviewer 1702，1178)

我们由衷感谢审稿人提供的建设性反馈，这些意见帮助我们识别出论文需要改进的关键方面。我们相信，通过认真回应这些问题，将显著提升论文在清晰度、完整性与影响力方面的整体质量。

此外，本补充材料也将附加在论文中，以便帮助读者对论文有更全面、更清晰地认识。FGAPA的代码也将公布在对应的github链接中。